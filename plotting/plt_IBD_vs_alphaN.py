import numpy as np
import matplotlib.pyplot as plt



E = np.array([
    0.9355,
    1.0065,
    1.0775,
    1.1485,
    1.2195,
    1.2905,
    1.3615,
    1.4325,
    1.5035,
    1.5745,
    1.6455,
    1.7165,
    1.7875,
    1.8585,
    1.9295,
    2.0005,
    2.0715,
    2.1425,
    2.2135,
    2.2845,
    2.3555,
    2.4265,
    2.4975,
    2.5685,
    2.6395,
    2.7105,
    2.7815,
    2.8525,
    2.9235,
    2.9945,
    3.0655,
    3.1365,
    3.2075,
    3.2785,
    3.3495,
    3.4205,
    3.4915,
    3.5625,
    3.6335,
    3.7045,
    3.7755,
    3.8465,
    3.9175,
    3.9885,
    4.0595,
    4.1305,
    4.2015,
    4.2725,
    4.3435,
    4.4145,
    4.4855,
    4.5565,
    4.6275,
    4.6985,
    4.7695,
    4.8405,
    4.9115,
    4.9825,
    5.0535,
    5.1245,
    5.1955,
    5.2665,
    5.3375,
    5.4085,
    5.4795,
    5.5505,
    5.6215,
    5.6925,
    5.7635,
    5.8345,
    5.9055,
    5.9765,
    6.0475,
    6.1185,
    6.1895,
    6.2605,
    6.3315,
    6.4025,
    6.4735,
    6.5445,
    6.6155,
    6.6865,
    6.7575,
    6.8285,
    6.8995,
    6.9705,
    7.0415,
    7.1125,
    7.1835,
    7.2545,
    7.3255,
    7.3965,
    7.4675,
    7.5385,
    7.6095,
    7.6805,
    7.7515,
    7.8225,
    7.8935,
    7.9645
], dtype=float)

IBD_prompt_flux = np.array([
    95.2727,
    260.137,
    414.375,
    586.109,
    491.122,
    787.052,
    1075.71,
    710.124,
    671.283,
    1576.09,
    1879.47,
    1162.77,
    888.059,
    1164.96,
    1803.83,
    2018.23,
    2264.32,
    2146.27,
    2084.33,
    1946.56,
    1999.66,
    1572.66,
    1114.97,
    1311.31,
    1827.6,
    2002.73,
    2396.13,
    2927.02,
    3232.78,
    3040.77,
    2620.51,
    2427.57,
    2045.03,
    1675.59,
    1496.16,
    1110.79,
    924.083,
    839.775,
    830.365,
    898.194,
    1008.25,
    1084.52,
    1104.57,
    1168.95,
    1317.91,
    1332.98,
    1468.34,
    1503.7,
    1598.23,
    1605.18,
    1584.13,
    1477.73,
    1358.49,
    1318.77,
    1140.09,
    1042.17,
    914.01,
    876.907,
    783.133,
    721.014,
    694.113,
    649.587,
    579.832,
    542.865,
    518.266,
    478.27,
    455.552,
    411.763,
    386.565,
    374.809,
    297.528,
    297.698,
    285.081,
    232.712,
    198.901,
    199.882,
    174.986,
    150.432,
    129.739,
    127.979,
    107.567,
    83.8993,
    77.4441,
    68.9972,
    51.4482,
    45.1989,
    28.256,
    26.3549,
    26.7024,
    10.4185,
    15.5574,
    6.1864,
    5.23005,
    1.59992,
    3.63239,
    3.05881,
    0.376923,
    3.00671,
    0.707901,
    0
], dtype=float)

alphaN_prompt_flux = np.array([
    1803,
    1900,
    1892,
    1956,
    1850,
    1715,
    1599,
    1436,
    1365,
    1186,
    1089,
    997,
    839,
    736,
    648,
    550,
    515,
    464,
    400,
    322,
    265,
    242,
    208,
    170,
    150,
    128,
    111,
    77,
    77,
    67,
    51,
    39,
    27,
    25,
    6,
    4,
    2,
    1,
    0,
    0,
    0,
    0,
    1,
    2,
    2,
    5,
    12,
    48,
    74,
    103,
    135,
    110,
    103,
    85,
    41,
    36,
    19,
    9,
    4,
    6,
    2,
    1,
    8,
    9,
    24,
    61,
    121,
    235,
    437,
    591,
    594,
    467,
    314,
    150,
    66,
    24,
    16,
    12,
    7,
    4,
    3,
    2,
    0,
    1,
    1,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0
], dtype=float)

# print('len(E) =', len(E))
# print('len(IBD_prompt_flux) =', len(IBD_prompt_flux))
# print('len(alphaN_prompt_flux) =', len(alphaN_prompt_flux))

dE = E[1] - E[0]
E_bins = np.linspace(E[0] - 0.5*dE, E[-1] + 0.5*dE, len(E) + 1)

# Normalise
IBD_prompt_flux /= np.sum(IBD_prompt_flux) * dE
alphaN_prompt_flux /= np.sum(alphaN_prompt_flux) * dE

k = 0.3

# plt.stairs(k * IBD_prompt_flux, E_bins, label='IBD', color='r')
# plt.stairs((1.0 - k) * alphaN_prompt_flux, E_bins, label=r'$\alpha$-n', color='b')
# plt.stairs(k * IBD_prompt_flux + (1.0 - k) * alphaN_prompt_flux, E_bins, label='total', color='k')

# plt.stairs(IBD_prompt_flux, E_bins, color='r')
plt.stairs(alphaN_prompt_flux, E_bins, color='b')

# plt.legend(loc='best')
plt.xlabel('reconstructed prompt E (MeV)')
plt.ylabel('Arbitrary')
# plt.title(r'IBD and $\alpha$-n prompt spectra')
# plt.title(r'IBD prompt spectrum')
plt.title(r'$\alpha$-n prompt spectrum')

plt.show()